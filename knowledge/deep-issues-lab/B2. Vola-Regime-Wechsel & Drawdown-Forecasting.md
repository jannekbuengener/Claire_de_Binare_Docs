---
id: CDB-DR-B2
title: 'Volatilitätsregime und Drawdown-Prognose'
subtitle: 'Methoden zur Erkennung von Marktphasen und Risikobewertung'
author: 'Jannek Buengener, ChatGPT, Claude Code, und Gemini'
date: '2025-12-17'
status: 'Refactored'
tags:
  - Volatilität
  - Regime-Wechsel
  - Drawdown-Forecasting
  - Risikomanagement
  - HMM
  - CVaR
---

# Volatilitätsregime und Drawdown-Prognose

> **Management Summary**
>
> Dieses Dokument untersucht mathematische Verfahren zur Erkennung von Volatilitätsregime-Wechseln und zur Vorhersage von Drawdowns in autonomen Krypto-Handelssystemen. Ziel ist es, die Robustheit von *Claire de Binare* durch eine adaptive Risikosteuerung zu erhöhen.
>
> Es werden Methoden wie **Change-Point-Detection** (z.B. BOCPD, CUSUM), **Markov-Regime-Modelle** (HMM) und **Rolling-Statistiken** zur Identifizierung von Volatilitätsregimen analysiert. Für die Drawdown-Vorhersage werden **Rolling Max-Peak-to-Trough-Analyse**, **Conditional Value at Risk (CVaR)** und **Extreme-Value-Theorie (EVT)** beleuchtet.
>
> Die Integration dieser Modelle in die Microservice-Architektur von *Claire de Binare* wird durch einen dedizierten `cdb_risk_regime`-Service vorgeschlagen, der Volatilitätsindikatoren berechnet und Regime-Scores in Echtzeit via Redis bereitstellt.

---

## 1. Erkennung von Volatilitätsregime-Wechseln

Das Identifizieren von Volatilitätsregime-Wechseln ist entscheidend für adaptives Risikomanagement. Verschiedene mathematische Verfahren bieten sich hierfür an:

### 1.1. Change-Point-Detection (CPD)

-   **Verfahren:** Analysiert Zeitreihen (z.B. historische Volatilität) auf abrupte Änderungen in Verteilungsparametern (Mittelwert, Varianz). Beispiele sind *Bayesian Online Change-Point Detection* (BOCPD) oder CUSUM-Verfahren.[^1]
-   **Anwendung:** Detektiert schlagartige Volatilitätswechsel durch das Suchen statistischer "Breakpoints".
-   **Stärken:** Theoretisch genaue Wechseldetektion.
-   **Schwächen:** Oft umfangreiche Modellannahmen erforderlich.

### 1.2. Markov-Regime-Modelle (HMM)

-   **Verfahren:** Beschreibt die Volatilität durch ein stochastisches Modell mit **latenten Zuständen** (z.B. "niedrige" vs. "hohe" Volatilität). Das HMM schätzt Übergangswahrscheinlichkeiten und Zustandsverteilungen aus Daten.[^2, ^3]
-   **Anwendung:** Das aktuelle Regime kann in Echtzeit gefiltert werden, um Handelsentscheidungen in Phasen hoher Volatilität zu blockieren oder anzupassen.[^4, ^5]
-   **Stärken:** Liefert probabilistische Zustände und erfasst die Persistenz von Regimen.
-   **Schwächen:** Erfordert aufwändige Schätzung und gute Trainingsdaten.

### 1.3. Rolling-Statistiken und Schwellenwerte

-   **Verfahren:** Nutzt einfache, regelbasierte Indikatoren wie gleitende Realized Volatilitäten oder technische Indikatoren (z.B. VIX-Future-Kurve) mit festen Schwellen.[^6, ^7]
-   **Anwendung:** Schnelle Absicherung, z.B. bei Überschreiten eines Schwellenwerts für die Realized Volatilität.
-   **Stärken:** Einfach zu implementieren.
-   **Schwächen:** Gefahr von Fehlauslösungen und Überanpassung; können zeitverzögert reagieren.

**Empfehlung:** Ein Ensemble-Ansatz, der die Stärken mehrerer Methoden kombiniert (z.B. Schwellenregeln mit HMM), kann die Robustheit erhöhen.

## 2. Verfahren zur Drawdown-Vorhersage / Frühwarnung

Ein Drawdown-Managementsystem ist entscheidend, um Kapital zu schützen und Verluste zu begrenzen.

### 2.1. Rolling Max-Peak-to-Trough-Analyse

-   **Verfahren:** Kontinuierliche Überwachung des aktuellen Drawdowns relativ zum letzten Equity-Hoch. Der Maximal Drawdown (MDD) ist der größte historische Rückgang.[^9]
-   **Anwendung:** Setzen von Echtzeit-Schwellen. Überschreitet der aktuelle Drawdown einen kritischen Wert (z.B. 80 % des historischen MDD), wird ein Frühwarnsignal ausgelöst. Täglich oder langfristig gleitende Verlustlimits stoppen den Handel bei Überschreitung.[^10]

### 2.2. Conditional Value at Risk (CVaR)

-   **Verfahren:** Ein Tail-Risiko-Maß, das den erwarteten Verlust jenseits eines Value-at-Risk (VaR)-Schwellenwerts quantifiziert.[^11]
-   **Anwendung:** Abschätzung der potenziellen Höhe extremer Verluste. Ein hoher CVaR kann auf ein erhöhtes Drawdown-Risiko hinweisen und einen Alarm auslösen.

### 2.3. Extreme-Value-Theorie (EVT)

-   **Verfahren:** Modelliert gezielt die Verteilung extremer Ereignisse (z.B. sehr seltene, aber schwere Rückschläge) mithilfe spezieller Verteilungen (z.B. Generalized Pareto-Verteilung).[^12, ^13]
-   **Anwendung:** Quantifizierung des Risikos extremer Marktbewegungen (z.B. Crashs) und Berechnung von sehr hohen Quantilen für Drawdowns.

## 3. Datenquellen

Die Modelle benötigen Zugang zu historischen und Echtzeit-Marktdaten sowie Performance-Historie des Bots:

-   **Redis (Echtzeit-Feeds):** Für aktuelle Preisdaten (`market_data`-Channel) und bereits berechnete Volatilitätsdaten (`vola_curve`-Channel).
-   **Interne Datenbank-Logs:** Historische `PortfolioSnapshots` (Equity, Drawdown) und `SimulatedTrades` für Kalibrierung und Backtesting.

## 4. Integration ins Claire-System

Es wird die Einführung eines eigenständigen Microservices, `cdb_risk_regime`, empfohlen.

### 4.1. `cdb_risk_regime` Microservice

-   **Funktion:** Dieser Service liest Redis-Streams, berechnet Volatilitätsindizes und führt Change-Point- oder HMM-Analysen durch.
-   **Output:** Publiziert den erkannten Risikoregime-Status (z.B. "ruhig", "moderat volatil", "panisch") für jedes Symbol in Redis (z.B. als Key `risk_state:BTC_USDT`).
-   **Zustand:** Der Service ist zustandslos oder speichert nur die jüngsten Daten im Arbeitsspeicher, um seinen aktuellen Zustand zu berechnen.

### 4.2. Schnittstelle zu Signal-Engine & Risk-Manager

-   **Risk Manager:** Der Risk Manager (`cdb_risk`) abonniert oder fragt den `risk_state`-Key in Redis ab. Bei einem erhöhten Regime-Score wendet er restriktivere Limits an (z.B. reduziert `MAX_POSITION_PCT`, setzt `HALT` für neue Trades).
-   **Signal Engine:** Die Signal Engine kann ebenfalls den Regime-Status nutzen, um ihre Signalerzeugung anzupassen (z.B. Schwellen erhöhen oder in Panikphasen komplett aussetzen).

### 4.3. Beispiel-Architektur & Pseudocode

```python
symbol = "BTC_USDT"
historical_prices = []
current_regime = None
HIGH_THRESHOLD = 0.05  # 5% annualisierte Volatilität
LOW_THRESHOLD = 0.02   # 2% annualisierte Volatilität

for market_event in subscribe_redis("market_data"):
    price = market_event["close"]
    historical_prices.append(price)

    # 1. Volatilitätskalkulation (z.B. Rolling-Std)
    vola = rolling_std(historical_prices[-100:], window=50)

    # 2. Regime-Erkennung (vereinfachte Threshold-Logik)
    if vola > HIGH_THRESHOLD:
        new_regime = "hohe_volatilitaet"
    elif vola < LOW_THRESHOLD:
        new_regime = "niedrige_volatilitaet"
    else:
        new_regime = current_regime # Regime bleibt unverändert

    # 3. Zustandsänderung publizieren
    if new_regime != current_regime:
        redis.set(f"risk_state:{symbol}", new_regime)
        current_regime = new_regime
```

## 5. Modell-Tuning, Validierung und Explainability

-   **Validierung:** Hyperparameter der Modelle (Fensterlängen, Schwellen, HMM-Zustände) werden auf historischen Daten kalibriert und mittels **Out-of-Sample-Tests** validiert, um Overfitting zu vermeiden. Kriterien sind Treffer-Rate der Wechsel, Fehlalarm-Rate und Verbesserung von Backtest-Metriken (z.B. Drawdown-Reduktion).
-   **Explainability:** Der `cdb_risk_regime`-Service soll seine Entscheidungen nachvollziehbar dokumentieren. Jedes ausgegebene Regime-Event sollte Gründe und Kennzahlen (z.B. aktuelle Volatilität, verwendete Schwellen) enthalten.

---

