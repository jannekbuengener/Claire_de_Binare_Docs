# Docker Container & Image Vulnerability Scan Report

**Scan Date:** 2025-12-23  
**Tool:** Docker Scout v1.18.3  
**Total Images Scanned:** 9 (5 custom-built + 4 third-party)

---

## Executive Summary

### Overall Security Posture: MODERATE RISK

**Critical Findings:**
- **4 CRITICAL** vulnerabilities found in redis:7-alpine (outdated Go stdlib 1.18.2)
- **5 HIGH** vulnerabilities in postgres:15-alpine (outdated Go stdlib 1.24.6)
- **40 HIGH** vulnerabilities in redis:7-alpine

**Key Issues:**
1. Third-party base images (Redis, PostgreSQL) have severely outdated dependencies
2. Custom Python-based images share common vulnerabilities (pip, tar, system libraries)
3. Execution service has significantly more vulnerabilities due to build tools (binutils)

---

## Vulnerability Breakdown by Image

### Custom-Built Images (Python-based)

#### 1. **cdb_paper_runner** (243 MB)
- **Vulnerabilities:** 31 total (0C, 0H, 2M, 29L)
- **Packages Affected:** 15/196
- **Key Issues:**
  - **MEDIUM**: pip 24.0 - CVE-2025-8869 (CVSS 5.9) - Link Following vulnerability
  - **MEDIUM**: tar 1.35 - CVE-2025-45582 - Needs security update
  - **LOW**: Multiple old CVEs in glibc, systemd, openldap, krb5 (mostly informational)

#### 2. **cdb_risk** (242 MB)
- **Vulnerabilities:** 32 total (0C, 0H, 2M, 30L)
- **Packages Affected:** 16/206
- **Key Issues:** Same as cdb_paper_runner + 1 additional LOW in bash-completion

#### 3. **cdb_core** (237 MB)
- **Vulnerabilities:** 32 total (0C, 0H, 2M, 30L)
- **Packages Affected:** 16/201
- **Key Issues:** Identical pattern to cdb_risk

#### 4. **cdb_db_writer** (224 MB)
- **Vulnerabilities:** 22 total (0C, 0H, 2M, 20L)
- **Packages Affected:** 11/151
- **Key Issues:** Fewer packages, same MEDIUM vulnerabilities (pip, tar)

#### 5. **cdb_execution** (722 MB) ‚ö†Ô∏è HIGHEST CUSTOM IMAGE RISK
- **Vulnerabilities:** 69 total (0C, 0H, 2M, 67L)
- **Packages Affected:** 18/278
- **Key Issues:**
  - **MEDIUM**: Same pip and tar issues as other custom images
  - **33 LOW** vulnerabilities in binutils 2.44-3 (build toolchain)
  - 4 additional LOW in patch utility
  - Significantly larger attack surface due to development tools

---

### Third-Party Base Images

#### 6. **postgres:15-alpine** (392 MB) ‚ö†Ô∏è HIGH PRIORITY
- **Vulnerabilities:** 12 total (0C, 5H, 7M, 0L)
- **Packages Affected:** 1/66
- **Critical Issue:** Go stdlib 1.24.6 needs update to 1.24.11
- **HIGH Severity CVEs:**
  - CVE-2025-61729, CVE-2025-61725, CVE-2025-61723
  - CVE-2025-58188, CVE-2025-58187
- **Recommended Action:** Update to postgres:15-alpine with Go 1.24.11+

#### 7. **redis:7-alpine** (61.2 MB) üö® CRITICAL PRIORITY
- **Vulnerabilities:** 77 total (4C, 40H, 30M, 3L)
- **Packages Affected:** 2/26
- **Critical Issues:**
  - **Go stdlib 1.18.2** - Extremely outdated (74 CVEs from 2022-2025)
  - **CRITICAL CVEs:**
    - CVE-2024-24790, CVE-2023-24540, CVE-2023-24538, CVE-2025-22871
  - **HIGH CVEs include:**
    - CVE-2023-44487 (CISA KEV - Known Exploited Vulnerability)
    - Multiple HTTP/2 vulnerabilities
    - Template injection vulnerabilities
- **Busybox:** 2 LOW CVEs
- **Recommended Action:** URGENT - Update to redis:7-alpine with Go 1.24.11+

#### 8. **grafana/grafana:latest** (994 MB)
- **Vulnerabilities:** 5 total (0C, 0H, 4M, 1L)
- **Packages Affected:** 3/598
- **Issues:**
  - **MEDIUM**: golang.org/x/crypto 0.43.0 needs update to 0.45.0
    - CVE-2025-58181 (CVSS 5.3) - Resource allocation issue
    - CVE-2025-47914 (CVSS 5.3) - Out-of-bounds read
  - **MEDIUM**: AWS SDK CVE-2020-8911 (no fix available)
  - **MEDIUM**: OpenFGA CVE-2025-64751 (CVSS 5.8) - Authorization issue
- **Status:** Relatively good, mostly minor issues

#### 9. **prom/prometheus:latest** (515 MB)
- **Vulnerabilities:** 2 total (0C, 0H, 2M, 0L)
- **Packages Affected:** 1/218
- **Issues:**
  - Same golang.org/x/crypto 0.43.0 issues as Grafana
- **Status:** Good security posture

---

## Common Vulnerabilities Across Custom Images

### Shared Issues (All Python-based services)

1. **pip 24.0 ‚Üí 25.3** (MEDIUM - CVE-2025-8869, CVSS 5.9)
   - Improper Link Resolution Before File Access
   - Affects all 5 custom images
   - Fix: Upgrade pip in Dockerfile

2. **tar 1.35+dfsg-3.1** (MEDIUM - CVE-2025-45582)
   - Affects all 5 custom images
   - Currently no fixed version in Debian Trixie
   - Low exploitability

3. **glibc 2.41-12** (7 LOW CVEs from 2010-2019)
   - Ancient CVEs, mostly theoretical
   - No fixes available (Debian considers these acceptable risk)

4. **systemd 257.9** (4 LOW CVEs)
   - CVE-2023-31437/38/39, CVE-2013-4392
   - Minimal concern for containerized environments

---

## Risk Assessment by Severity

### üö® CRITICAL (4 vulnerabilities)
- **Location:** redis:7-alpine only
- **Impact:** Remote code execution, DoS, template injection
- **Action Required:** IMMEDIATE UPDATE

### ‚ö†Ô∏è HIGH (45 vulnerabilities)
- **Primary Source:** redis:7-alpine (40), postgres:15-alpine (5)
- **Impact:** DoS, memory corruption, HTTP/2 attacks
- **Action Required:** HIGH PRIORITY UPDATE

### üìã MEDIUM (60 vulnerabilities)
- **Distribution:** 
  - Custom images: 10 (2 per image √ó 5)
  - Third-party: 50 (mostly in redis, grafana, prometheus)
- **Impact:** Information disclosure, DoS, improper validation
- **Action Required:** MEDIUM PRIORITY - Update during next maintenance

### ‚ÑπÔ∏è LOW (134 vulnerabilities)
- **Distribution:**
  - Custom images: 131 (mostly in cdb_execution due to binutils)
  - Third-party: 3 (busybox in redis)
- **Impact:** Minimal - mostly theoretical or requires specific conditions
- **Action Required:** LOW PRIORITY - Update when convenient

---

## Recommended Remediation Actions

### Priority 1 (URGENT - Within 24 hours)

1. **Update redis:7-alpine**
   ```dockerfile
   # Current: redis:7-alpine (Go 1.18.2)
   # Replace with latest version or wait for official update
   # Alternative: Use redis:7-bullseye (larger but more maintained)
   ```
   **Risk:** Contains CISA KEV vulnerability (CVE-2023-44487)

2. **Update postgres:15-alpine**
   ```dockerfile
   # Pull latest patch version
   FROM postgres:15.X-alpine  # where X is latest
   ```

### Priority 2 (HIGH - Within 1 week)

3. **Update pip in all custom images**
   ```dockerfile
   # In all Python service Dockerfiles
   RUN pip install --upgrade pip==25.3
   ```

4. **Update golang.org/x/crypto in Grafana & Prometheus**
   - Check for official image updates
   - Grafana and Prometheus teams should release updates soon

### Priority 3 (MEDIUM - Within 1 month)

5. **Consider alternative base images**
   - Evaluate using Debian Bookworm (stable) instead of Trixie (testing)
   - Monitor tar package updates in Debian
   - Review if binutils is necessary in cdb_execution

6. **Implement vulnerability scanning in CI/CD**
   ```yaml
   # Add to GitHub Actions / GitLab CI
   - name: Scan Docker image
     run: docker scout cves $IMAGE_NAME
   ```

### Priority 4 (LOW - Ongoing monitoring)

7. **Monitor LOW severity CVEs**
   - Most are old and have no fixes
   - Debian security team tracks these
   - Review quarterly

---

## Security Best Practices Moving Forward

### 1. **Base Image Strategy**
- Use Alpine for smaller attack surface (Redis issue is exceptional)
- Pin specific versions (not `:latest`) for reproducibility
- Regularly update base images (monthly cadence)

### 2. **Dependency Management**
- Pin Python package versions in requirements.txt
- Use `pip freeze` for reproducible builds
- Scan dependencies before adding

### 3. **Image Optimization**
- Reduce cdb_execution size (722 MB is excessive)
- Use multi-stage builds to exclude build tools from runtime
- Remove unnecessary packages

### 4. **Continuous Monitoring**
- Integrate Docker Scout into CI/CD pipeline
- Set up automated alerts for CRITICAL/HIGH CVEs
- Scan on every build and weekly for running containers

### 5. **Network Segmentation**
- Ensure Redis and PostgreSQL are not exposed to public internet
- Use Docker networks to isolate services
- Implement least-privilege access controls

---

## Example Dockerfile Improvements

### For Custom Python Services (cdb_*)

```dockerfile
# Before
FROM python:3.12-slim-bookworm
RUN pip install -r requirements.txt

# After - More Secure
FROM python:3.12-slim-bookworm as builder

# Upgrade pip to latest
RUN pip install --upgrade pip==25.3

# Install dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Runtime stage (minimal)
FROM python:3.12-slim-bookworm
COPY --from=builder /usr/local/lib/python3.12/site-packages /usr/local/lib/python3.12/site-packages
COPY . /app
WORKDIR /app

# Run as non-root
RUN useradd -m -u 1000 appuser
USER appuser
```

### For cdb_execution (Reduce Size)

```dockerfile
# Use multi-stage build
FROM python:3.12-slim-bookworm as builder

# Install build dependencies
RUN apt-get update && apt-get install -y --no-install-recommends \
    gcc \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

RUN pip install --upgrade pip==25.3
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Runtime stage - NO BUILD TOOLS
FROM python:3.12-slim-bookworm
COPY --from=builder /usr/local/lib/python3.12/site-packages /usr/local/lib/python3.12/site-packages
COPY . /app
WORKDIR /app
# Size should drop from 722MB to ~250MB
```

---

## Conclusion

**Overall Assessment:** The custom-built images have acceptable vulnerability profiles for development/staging environments. The primary concerns are:

1. **Redis container requires immediate attention** (4 CRITICAL, 40 HIGH)
2. **PostgreSQL needs update** (5 HIGH)
3. **Custom images need pip upgrade** (straightforward fix)

The majority of LOW severity vulnerabilities are inherited from Debian base system packages and are tracked by Debian security team. These pose minimal real-world risk in properly configured container environments.

**Estimated remediation time:**
- Priority 1 (Redis/Postgres): 2-4 hours
- Priority 2 (pip upgrade): 1-2 hours
- Priority 3 (optimization): 8-16 hours
- **Total: ~2-3 days** for comprehensive security improvements

---

## Additional Resources

- [Docker Scout Documentation](https://docs.docker.com/scout/)
- [NIST National Vulnerability Database](https://nvd.nist.gov/)
- [CISA Known Exploited Vulnerabilities](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)
- [Debian Security Tracker](https://security-tracker.debian.org/)
- [Go Vulnerability Database](https://vuln.go.dev/)

---

**Report Generated By:** Docker Security Scan (Automated)  
**Next Scan Recommended:** Weekly for running containers, on every build for new images
Result

Error: path vulnerability-scan-report.md is not within allowed directories
Dec 23, 2025 8:50 AM